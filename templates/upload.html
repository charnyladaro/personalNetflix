<!-- templates/upload.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Upload Movie - Personal Netflix</title>
</head>
<body>
    {% extends "base.html" %}

    {% block content %}
    <div class="container">
        <div class="form-container" style="max-width: 700px;">
            <h2>Upload New Content</h2>
            <form method="POST" enctype="multipart/form-data" id="uploadForm">
                
                <!-- Content Type Selection -->
                <div class="form-group">
                    <label style="font-weight: bold; margin-bottom: 15px; display: block;">Content Type:</label>
                    <div class="content-type-selector">
                        <label class="content-type-option">
                            <input type="radio" name="content_type" value="movie" checked onchange="toggleSeriesFields()">
                            <span class="radio-custom"></span>
                            <span class="option-text">ðŸŽ¬ Movie</span>
                        </label>
                        <label class="content-type-option">
                            <input type="radio" name="content_type" value="series" onchange="toggleSeriesFields()">
                            <span class="radio-custom"></span>
                            <span class="option-text">ðŸ“º TV Series Episode</span>
                        </label>
                    </div>
                </div>

                <!-- Basic Information -->
                <div class="form-group">
                    <label for="title" id="titleLabel">Title:</label>
                    <input type="text" id="title" name="title" required>
                </div>

                <!-- Series-specific fields (hidden by default) -->
                <div id="seriesFields" style="display: none;">
                    <div class="series-section">
                        <h3 style="color: #4CAF50; margin: 20px 0 15px 0;">ðŸ“º Series Information</h3>
                        
                        <div class="form-group">
                            <label for="series_name">Series Name:</label>
                            <input type="text" id="series_name" name="series_name" placeholder="e.g., Breaking Bad, The Office">
                            <small style="color: #aaa;">The name of the TV series this episode belongs to</small>
                        </div>

                        <div class="form-row">
                            <div class="form-group" style="flex: 1; margin-right: 10px;">
                                <label for="season_number">Season Number:</label>
                                <input type="number" id="season_number" name="season_number" min="1" placeholder="1">
                            </div>
                            <div class="form-group" style="flex: 1; margin-left: 10px;">
                                <label for="episode_number">Episode Number:</label>
                                <input type="number" id="episode_number" name="episode_number" min="1" placeholder="1">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="episode_title">Episode Title (Optional):</label>
                            <input type="text" id="episode_title" name="episode_title" placeholder="e.g., Pilot, The One Where...">
                            <small style="color: #aaa;">Leave blank to use the main title for this episode</small>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="description">Description:</label>
                    <textarea id="description" name="description" rows="4" placeholder="Brief description of the content..."></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group" style="flex: 1; margin-right: 10px;">
                        <label for="genre">Genre:</label>
                        <input type="text" id="genre" name="genre" placeholder="e.g., Action, Comedy, Drama">
                    </div>
                    <div class="form-group" style="flex: 1; margin-left: 10px;">
                        <label for="release_year">Release Year:</label>
                        <input type="number" id="release_year" name="release_year" min="1900" max="2030">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="duration">Duration (minutes):</label>
                    <input type="number" id="duration" name="duration" min="1" placeholder="e.g., 120">
                </div>
                
                <div class="form-group">
                    <label for="video_file">Video File:</label>
                    <input type="file" id="video_file" name="video_file" accept=".mp4,.avi,.mkv,.mov,.wmv" required>
                    <small style="color: #aaa;">Supported formats: MP4, AVI, MKV, MOV, WMV</small>
                </div>
                
                <div class="form-group">
                    <label for="thumbnail_file">Thumbnail (optional):</label>
                    <input type="file" id="thumbnail_file" name="thumbnail_file" accept=".png,.jpg,.jpeg,.gif">
                    <small style="color: #aaa;">Supported formats: PNG, JPG, JPEG, GIF. Leave blank for auto-generation.</small>
                </div>

                <!-- Hidden field for series checkbox -->
                <input type="hidden" id="is_series" name="is_series" value="">
                
                <div class="button-group">
                    <button type="submit" class="btn" id="submitBtn">Upload Movie</button>
                    <a href="{{ url_for('admin') }}" class="btn btn-secondary" style="margin-left: 10px;">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    <style>
        .content-type-selector {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .content-type-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 15px 20px;
            background-color: #333;
            border-radius: 8px;
            border: 2px solid #555;
            transition: all 0.3s ease;
            flex: 1;
        }

        .content-type-option:hover {
            border-color: #e50914;
            background-color: #444;
        }

        .content-type-option input[type="radio"] {
            display: none;
        }

        .content-type-option input[type="radio"]:checked + .radio-custom {
            background-color: #e50914;
            border-color: #e50914;
        }

        .content-type-option input[type="radio"]:checked + .radio-custom::after {
            opacity: 1;
        }

        .content-type-option input[type="radio"]:checked ~ .option-text {
            color: #e50914;
            font-weight: bold;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid #666;
            border-radius: 50%;
            margin-right: 10px;
            position: relative;
            transition: all 0.3s ease;
        }

        .radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background-color: white;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .option-text {
            font-size: 16px;
            color: white;
            transition: all 0.3s ease;
        }

        .series-section {
            background-color: rgba(76, 175, 80, 0.1);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(76, 175, 80, 0.3);
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            gap: 20px;
        }

        .button-group {
            margin-top: 30px;
        }

        #submitBtn {
            min-width: 150px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .content-type-selector {
                flex-direction: column;
                gap: 10px;
            }

            .form-row {
                flex-direction: column;
                gap: 0;
            }

            .form-row .form-group {
                margin: 0 0 20px 0 !important;
            }
        }

        /* Form animations */
        #seriesFields {
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .series-section {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>

    <script>
        function toggleSeriesFields() {
            const contentType = document.querySelector('input[name="content_type"]:checked').value;
            const seriesFields = document.getElementById('seriesFields');
            const isSeriesInput = document.getElementById('is_series');
            const submitBtn = document.getElementById('submitBtn');
            const titleLabel = document.getElementById('titleLabel');
            const seriesNameInput = document.getElementById('series_name');
            const seasonInput = document.getElementById('season_number');
            const episodeInput = document.getElementById('episode_number');

            if (contentType === 'series') {
                seriesFields.style.display = 'block';
                isSeriesInput.value = 'on';
                submitBtn.textContent = 'ðŸ“º Upload Episode';
                titleLabel.textContent = 'Episode Title:';
                
                // Make series fields required
                seriesNameInput.required = true;
                seasonInput.required = true;
                episodeInput.required = true;
            } else {
                seriesFields.style.display = 'none';
                isSeriesInput.value = '';
                submitBtn.textContent = 'ðŸŽ¬ Upload Movie';
                titleLabel.textContent = 'Title:';
                
                // Remove required from series fields
                seriesNameInput.required = false;
                seasonInput.required = false;
                episodeInput.required = false;
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            toggleSeriesFields();
        });

        // Form validation
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            const contentType = document.querySelector('input[name="content_type"]:checked').value;
            
            if (contentType === 'series') {
                const seriesName = document.getElementById('series_name').value.trim();
                const seasonNumber = document.getElementById('season_number').value;
                const episodeNumber = document.getElementById('episode_number').value;
                
                if (!seriesName || !seasonNumber || !episodeNumber) {
                    e.preventDefault();
                    alert('Please fill in all required series information (Series Name, Season Number, Episode Number).');
                    return false;
                }
            }
        });
    </script>
    {% endblock %}
</body>
</html>